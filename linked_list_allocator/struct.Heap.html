<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="A fixed size heap backed by a linked list of free memory blocks."><meta name="keywords" content="rust, rustlang, rust-lang, Heap"><title>Heap in linked_list_allocator - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../ayu.css" disabled><link rel="stylesheet" type="text/css" href="../dark.css" disabled><link rel="stylesheet" type="text/css" href="../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../storage.js"></script><script src="../crates.js"></script><script defer src="../main.js"></script>
    <noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../favicon.svg"></head><body class="rustdoc struct"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a class="sidebar-logo" href="../linked_list_allocator/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.png" alt="logo"></div>
        </a><h2 class="location">Struct Heap</h2><div class="sidebar-elems"><div class="block items"><h3 class="sidebar-title"><a href="#implementations">Methods</a></h3><div class="sidebar-links"><a href="#method.allocate_first_fit">allocate_first_fit</a><a href="#method.bottom">bottom</a><a href="#method.deallocate">deallocate</a><a href="#method.empty">empty</a><a href="#method.extend">extend</a><a href="#method.free">free</a><a href="#method.from_slice">from_slice</a><a href="#method.init">init</a><a href="#method.init_from_slice">init_from_slice</a><a href="#method.new">new</a><a href="#method.size">size</a><a href="#method.top">top</a><a href="#method.used">used</a></div><h3 class="sidebar-title"><a href="#synthetic-implementations">Auto Trait Implementations</a></h3><div class="sidebar-links"><a href="#impl-RefUnwindSafe">RefUnwindSafe</a><a href="#impl-Send">Send</a><a href="#impl-Sync">Sync</a><a href="#impl-Unpin">Unpin</a><a href="#impl-UnwindSafe">!UnwindSafe</a></div><h3 class="sidebar-title"><a href="#blanket-implementations">Blanket Implementations</a></h3><div class="sidebar-links"><a href="#impl-Any">Any</a><a href="#impl-Borrow%3CT%3E">Borrow&lt;T&gt;</a><a href="#impl-BorrowMut%3CT%3E">BorrowMut&lt;T&gt;</a><a href="#impl-From%3CT%3E">From&lt;T&gt;</a><a href="#impl-Into%3CU%3E">Into&lt;U&gt;</a><a href="#impl-TryFrom%3CU%3E">TryFrom&lt;U&gt;</a><a href="#impl-TryInto%3CU%3E">TryInto&lt;U&gt;</a></div></div><h2 class="location">Other items in<br><a href="index.html">linked_list_allocator</a></h2><div id="sidebar-vars" data-name="Heap" data-ty="struct" data-relpath=""></div><script defer src="sidebar-items.js"></script></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../linked_list_allocator/index.html"><img class="rust-logo" src="../rust-logo.png" alt="logo"></a><nav class="sub"><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img width="18" height="18" alt="Pick another theme!" src="../brush.svg"></button><div id="theme-choices" role="menu"></div></div><form class="search-form"><div class="search-container"><div>
                                <input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../settings.html" title="settings"><img width="18" height="18" alt="Change settings" src="../wheel.svg"></a></div></form></nav></div><section id="main-content" class="content"><div class="main-heading">
    <h1 class="fqn"><span class="in-band">Struct <a href="index.html">linked_list_allocator</a>::<wbr><a class="struct" href="#">Heap</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span></h1><span class="out-of-band">
        <a class="srclink" href="../src/linked_list_allocator/lib.rs.html#35-40" title="goto source code">source</a> ·
        <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div>
<div class="docblock item-decl"><pre class="rust struct"><code>pub struct Heap { /* fields omitted */ }</code></pre></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>A fixed size heap backed by a linked list of free memory blocks.</p>
</div></details><h2 id="implementations" class="small-section-header">Implementations<a href="#implementations" class="anchor"></a></h2><details class="rustdoc-toggle implementors-toggle" open><summary><div id="impl" class="impl has-srclink"><div class="rightside"><a class="srclink" href="../src/linked_list_allocator/lib.rs.html#42-195" title="goto source code">source</a></div><a href="#impl" class="anchor"></a><h3 class="code-header in-band">impl <a class="struct" href="struct.Heap.html" title="struct linked_list_allocator::Heap">Heap</a></h3></div></summary><div class="impl-items"><div id="method.empty" class="method has-srclink"><div class="rightside"><a class="srclink" href="../src/linked_list_allocator/lib.rs.html#55-62" title="goto source code">source</a></div><a href="#method.empty" class="anchor"></a><h4 class="code-header">pub const fn <a href="#method.empty" class="fnname">empty</a>() -&gt; <a class="struct" href="struct.Heap.html" title="struct linked_list_allocator::Heap">Heap</a></h4></div><details class="rustdoc-toggle method-toggle" open><summary><div id="method.init" class="method has-srclink"><div class="rightside"><a class="srclink" href="../src/linked_list_allocator/lib.rs.html#70-75" title="goto source code">source</a></div><a href="#method.init" class="anchor"></a><h4 class="code-header">pub unsafe fn <a href="#method.init" class="fnname">init</a>(&amp;mut self, heap_bottom: usize, heap_size: usize)</h4></div></summary><div class="docblock"><p>Initializes an empty heap</p>
<h5 id="unsafety" class="section-header"><a href="#unsafety">Unsafety</a></h5>
<p>This function must be called at most once and must only be used on an
empty heap.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.init_from_slice" class="method has-srclink"><div class="rightside"><a class="srclink" href="../src/linked_list_allocator/lib.rs.html#91-101" title="goto source code">source</a></div><a href="#method.init_from_slice" class="anchor"></a><h4 class="code-header">pub fn <a href="#method.init_from_slice" class="fnname">init_from_slice</a>(&amp;mut self, mem: &amp;'static mut [MaybeUninit&lt;u8&gt;])</h4></div></summary><div class="docblock"><p>Initialize an empty heap with provided memory.</p>
<p>The caller is responsible for procuring a region of raw memory that may be utilized by the
allocator. This might be done via any method such as (unsafely) taking a region from the
program’s memory, from a mutable static, or by allocating and leaking such memory from
another allocator.</p>
<p>The latter method may be especially useful if the underlying allocator does not perform
deallocation (e.g. a simple bump allocator). Then the overlaid linked-list-allocator can
provide memory reclamation.</p>
<h5 id="panics" class="section-header"><a href="#panics">Panics</a></h5>
<p>This method panics if the heap is already initialized.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.new" class="method has-srclink"><div class="rightside"><a class="srclink" href="../src/linked_list_allocator/lib.rs.html#107-118" title="goto source code">source</a></div><a href="#method.new" class="anchor"></a><h4 class="code-header">pub unsafe fn <a href="#method.new" class="fnname">new</a>(heap_bottom: usize, heap_size: usize) -&gt; <a class="struct" href="struct.Heap.html" title="struct linked_list_allocator::Heap">Heap</a></h4></div></summary><div class="docblock"><p>Creates a new heap with the given <code>bottom</code> and <code>size</code>. The bottom address must be valid
and the memory in the <code>[heap_bottom, heap_bottom + heap_size)</code> range must not be used for
anything else. This function is unsafe because it can cause undefined behavior if the
given address is invalid.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.from_slice" class="method has-srclink"><div class="rightside"><a class="srclink" href="../src/linked_list_allocator/lib.rs.html#124-130" title="goto source code">source</a></div><a href="#method.from_slice" class="anchor"></a><h4 class="code-header">pub fn <a href="#method.from_slice" class="fnname">from_slice</a>(mem: &amp;'static mut [MaybeUninit&lt;u8&gt;]) -&gt; <a class="struct" href="struct.Heap.html" title="struct linked_list_allocator::Heap">Heap</a></h4></div></summary><div class="docblock"><p>Creates a new heap from a slice of raw memory.</p>
<p>This has the same effect as [<code>init_from_slice</code>] on an empty heap, but it is combined into a
single operation that can not panic.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.allocate_first_fit" class="method has-srclink"><div class="rightside"><a class="srclink" href="../src/linked_list_allocator/lib.rs.html#137-145" title="goto source code">source</a></div><a href="#method.allocate_first_fit" class="anchor"></a><h4 class="code-header">pub fn <a href="#method.allocate_first_fit" class="fnname">allocate_first_fit</a>(&amp;mut self, layout: Layout) -&gt; Result&lt;NonNull&lt;u8&gt;, ()&gt;</h4></div></summary><div class="docblock"><p>Allocates a chunk of the given size with the given alignment. Returns a pointer to the
beginning of that chunk if it was successful. Else it returns <code>None</code>.
This function scans the list of free memory blocks and uses the first block that is big
enough. The runtime is in O(n) where n is the number of free blocks, but it should be
reasonably fast for small allocations.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.deallocate" class="method has-srclink"><div class="rightside"><a class="srclink" href="../src/linked_list_allocator/lib.rs.html#154-156" title="goto source code">source</a></div><a href="#method.deallocate" class="anchor"></a><h4 class="code-header">pub unsafe fn <a href="#method.deallocate" class="fnname">deallocate</a>(&amp;mut self, ptr: NonNull&lt;u8&gt;, layout: Layout)</h4></div></summary><div class="docblock"><p>Frees the given allocation. <code>ptr</code> must be a pointer returned
by a call to the <code>allocate_first_fit</code> function with identical size and alignment. Undefined
behavior may occur for invalid arguments, thus this function is unsafe.</p>
<p>This function walks the list of free memory blocks and inserts the freed block at the
correct place. If the freed block is adjacent to another free block, the blocks are merged
again. This operation is in <code>O(n)</code> since the list needs to be sorted by address.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.bottom" class="method has-srclink"><div class="rightside"><a class="srclink" href="../src/linked_list_allocator/lib.rs.html#159-161" title="goto source code">source</a></div><a href="#method.bottom" class="anchor"></a><h4 class="code-header">pub fn <a href="#method.bottom" class="fnname">bottom</a>(&amp;self) -&gt; usize</h4></div></summary><div class="docblock"><p>Returns the bottom address of the heap.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.size" class="method has-srclink"><div class="rightside"><a class="srclink" href="../src/linked_list_allocator/lib.rs.html#164-166" title="goto source code">source</a></div><a href="#method.size" class="anchor"></a><h4 class="code-header">pub fn <a href="#method.size" class="fnname">size</a>(&amp;self) -&gt; usize</h4></div></summary><div class="docblock"><p>Returns the size of the heap.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.top" class="method has-srclink"><div class="rightside"><a class="srclink" href="../src/linked_list_allocator/lib.rs.html#169-171" title="goto source code">source</a></div><a href="#method.top" class="anchor"></a><h4 class="code-header">pub fn <a href="#method.top" class="fnname">top</a>(&amp;self) -&gt; usize</h4></div></summary><div class="docblock"><p>Return the top address of the heap</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.used" class="method has-srclink"><div class="rightside"><a class="srclink" href="../src/linked_list_allocator/lib.rs.html#174-176" title="goto source code">source</a></div><a href="#method.used" class="anchor"></a><h4 class="code-header">pub fn <a href="#method.used" class="fnname">used</a>(&amp;self) -&gt; usize</h4></div></summary><div class="docblock"><p>Returns the size of the used part of the heap</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.free" class="method has-srclink"><div class="rightside"><a class="srclink" href="../src/linked_list_allocator/lib.rs.html#179-181" title="goto source code">source</a></div><a href="#method.free" class="anchor"></a><h4 class="code-header">pub fn <a href="#method.free" class="fnname">free</a>(&amp;self) -&gt; usize</h4></div></summary><div class="docblock"><p>Returns the size of the free part of the heap</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.extend" class="method has-srclink"><div class="rightside"><a class="srclink" href="../src/linked_list_allocator/lib.rs.html#188-194" title="goto source code">source</a></div><a href="#method.extend" class="anchor"></a><h4 class="code-header">pub unsafe fn <a href="#method.extend" class="fnname">extend</a>(&amp;mut self, by: usize)</h4></div></summary><div class="docblock"><p>Extends the size of the heap by creating a new hole at the end</p>
<h5 id="unsafety-1" class="section-header"><a href="#unsafety-1">Unsafety</a></h5>
<p>The new extended area must be valid</p>
</div></details></div></details><h2 id="synthetic-implementations" class="small-section-header">Auto Trait Implementations<a href="#synthetic-implementations" class="anchor"></a></h2><div id="synthetic-implementations-list"><div id="impl-RefUnwindSafe" class="impl has-srclink"><div class="rightside"></div><a href="#impl-RefUnwindSafe" class="anchor"></a><h3 class="code-header in-band">impl RefUnwindSafe for <a class="struct" href="struct.Heap.html" title="struct linked_list_allocator::Heap">Heap</a></h3></div><div id="impl-Send" class="impl has-srclink"><div class="rightside"></div><a href="#impl-Send" class="anchor"></a><h3 class="code-header in-band">impl Send for <a class="struct" href="struct.Heap.html" title="struct linked_list_allocator::Heap">Heap</a></h3></div><div id="impl-Sync" class="impl has-srclink"><div class="rightside"></div><a href="#impl-Sync" class="anchor"></a><h3 class="code-header in-band">impl Sync for <a class="struct" href="struct.Heap.html" title="struct linked_list_allocator::Heap">Heap</a></h3></div><div id="impl-Unpin" class="impl has-srclink"><div class="rightside"></div><a href="#impl-Unpin" class="anchor"></a><h3 class="code-header in-band">impl Unpin for <a class="struct" href="struct.Heap.html" title="struct linked_list_allocator::Heap">Heap</a></h3></div><div id="impl-UnwindSafe" class="impl has-srclink"><div class="rightside"></div><a href="#impl-UnwindSafe" class="anchor"></a><h3 class="code-header in-band">impl !UnwindSafe for <a class="struct" href="struct.Heap.html" title="struct linked_list_allocator::Heap">Heap</a></h3></div></div><h2 id="blanket-implementations" class="small-section-header">Blanket Implementations<a href="#blanket-implementations" class="anchor"></a></h2><div id="blanket-implementations-list"><details class="rustdoc-toggle implementors-toggle" open><summary><div id="impl-Any" class="impl has-srclink"><div class="rightside"></div><a href="#impl-Any" class="anchor"></a><h3 class="code-header in-band">impl&lt;T&gt; Any for T <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;T: 'static + ?Sized,&nbsp;</span></h3></div></summary><div class="impl-items"><details class="rustdoc-toggle method-toggle" open><summary><div id="method.type_id" class="method trait-impl has-srclink"><div class="rightside"></div><a href="#method.type_id" class="anchor"></a><h4 class="code-header">pub fn <a  class="fnname">type_id</a>(&amp;self) -&gt; TypeId</h4></div></summary><div class='docblock'><p>Gets the <code>TypeId</code> of <code>self</code>. <a href="#tymethod.type_id">Read more</a></p>
</div></details></div></details><details class="rustdoc-toggle implementors-toggle" open><summary><div id="impl-Borrow%3CT%3E" class="impl has-srclink"><div class="rightside"></div><a href="#impl-Borrow%3CT%3E" class="anchor"></a><h3 class="code-header in-band">impl&lt;T&gt; Borrow&lt;T&gt; for T <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;T: ?Sized,&nbsp;</span></h3></div></summary><div class="impl-items"><details class="rustdoc-toggle method-toggle" open><summary><div id="method.borrow" class="method trait-impl has-srclink"><div class="rightside"></div><a href="#method.borrow" class="anchor"></a><h4 class="code-header">pub fn <a  class="fnname">borrow</a>(&amp;self) -&gt; &amp;T</h4></div></summary><div class='docblock'><p>Immutably borrows from an owned value. <a href="#tymethod.borrow">Read more</a></p>
</div></details></div></details><details class="rustdoc-toggle implementors-toggle" open><summary><div id="impl-BorrowMut%3CT%3E" class="impl has-srclink"><div class="rightside"></div><a href="#impl-BorrowMut%3CT%3E" class="anchor"></a><h3 class="code-header in-band">impl&lt;T&gt; BorrowMut&lt;T&gt; for T <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;T: ?Sized,&nbsp;</span></h3></div></summary><div class="impl-items"><details class="rustdoc-toggle method-toggle" open><summary><div id="method.borrow_mut" class="method trait-impl has-srclink"><div class="rightside"></div><a href="#method.borrow_mut" class="anchor"></a><h4 class="code-header">pub fn <a  class="fnname">borrow_mut</a>(&amp;mut self) -&gt; &amp;mut T</h4></div></summary><div class='docblock'><p>Mutably borrows from an owned value. <a href="#tymethod.borrow_mut">Read more</a></p>
</div></details></div></details><details class="rustdoc-toggle implementors-toggle" open><summary><div id="impl-From%3CT%3E" class="impl has-srclink"><div class="rightside"></div><a href="#impl-From%3CT%3E" class="anchor"></a><h3 class="code-header in-band">impl&lt;T&gt; From&lt;T&gt; for T</h3></div></summary><div class="impl-items"><details class="rustdoc-toggle method-toggle" open><summary><div id="method.from" class="method trait-impl has-srclink"><div class="rightside"></div><a href="#method.from" class="anchor"></a><h4 class="code-header">pub fn <a  class="fnname">from</a>(t: T) -&gt; T</h4></div></summary><div class='docblock'><p>Performs the conversion.</p>
</div></details></div></details><details class="rustdoc-toggle implementors-toggle" open><summary><div id="impl-Into%3CU%3E" class="impl has-srclink"><div class="rightside"></div><a href="#impl-Into%3CU%3E" class="anchor"></a><h3 class="code-header in-band">impl&lt;T, U&gt; Into&lt;U&gt; for T <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;U: From&lt;T&gt;,&nbsp;</span></h3></div></summary><div class="impl-items"><details class="rustdoc-toggle method-toggle" open><summary><div id="method.into" class="method trait-impl has-srclink"><div class="rightside"></div><a href="#method.into" class="anchor"></a><h4 class="code-header">pub fn <a  class="fnname">into</a>(self) -&gt; U</h4></div></summary><div class='docblock'><p>Performs the conversion.</p>
</div></details></div></details><details class="rustdoc-toggle implementors-toggle" open><summary><div id="impl-TryFrom%3CU%3E" class="impl has-srclink"><div class="rightside"></div><a href="#impl-TryFrom%3CU%3E" class="anchor"></a><h3 class="code-header in-band">impl&lt;T, U&gt; TryFrom&lt;U&gt; for T <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;U: Into&lt;T&gt;,&nbsp;</span></h3></div></summary><div class="impl-items"><details class="rustdoc-toggle" open><summary><div id="associatedtype.Error" class="type trait-impl has-srclink"><a href="#associatedtype.Error" class="anchor"></a><h4 class="code-header">type <a href="#associatedtype.Error" class="associatedtype">Error</a> = Infallible</h4></div></summary><div class='docblock'><p>The type returned in the event of a conversion error.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.try_from" class="method trait-impl has-srclink"><div class="rightside"></div><a href="#method.try_from" class="anchor"></a><h4 class="code-header">pub fn <a  class="fnname">try_from</a>(value: U) -&gt; Result&lt;T, &lt;T as TryFrom&lt;U&gt;&gt;::Error&gt;</h4></div></summary><div class='docblock'><p>Performs the conversion.</p>
</div></details></div></details><details class="rustdoc-toggle implementors-toggle" open><summary><div id="impl-TryInto%3CU%3E" class="impl has-srclink"><div class="rightside"></div><a href="#impl-TryInto%3CU%3E" class="anchor"></a><h3 class="code-header in-band">impl&lt;T, U&gt; TryInto&lt;U&gt; for T <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;U: TryFrom&lt;T&gt;,&nbsp;</span></h3></div></summary><div class="impl-items"><details class="rustdoc-toggle" open><summary><div id="associatedtype.Error-1" class="type trait-impl has-srclink"><a href="#associatedtype.Error-1" class="anchor"></a><h4 class="code-header">type <a href="#associatedtype.Error" class="associatedtype">Error</a> = &lt;U as TryFrom&lt;T&gt;&gt;::Error</h4></div></summary><div class='docblock'><p>The type returned in the event of a conversion error.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.try_into" class="method trait-impl has-srclink"><div class="rightside"></div><a href="#method.try_into" class="anchor"></a><h4 class="code-header">pub fn <a  class="fnname">try_into</a>(self) -&gt; Result&lt;U, &lt;U as TryFrom&lt;T&gt;&gt;::Error&gt;</h4></div></summary><div class='docblock'><p>Performs the conversion.</p>
</div></details></div></details></div></section><section id="search" class="content hidden"></section></div></main><div id="rustdoc-vars" data-root-path="../" data-current-crate="linked_list_allocator" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.60.0-nightly (89b9f7b28 2022-01-10)" ></div>
</body></html>